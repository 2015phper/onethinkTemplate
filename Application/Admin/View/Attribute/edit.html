<extend name="Public/base" />

<block name="body">

    
    <div class="row">
        <div class="col-md-12">
            
            <div class="tabbable tabbable-custom boxless">
                <form id="form" action="{:U('update')}" method="post" class="form-1">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#tab_1" data-toggle="tab">基 础</a></li>
                    <li><a href="#tab_2" data-toggle="tab">高 级</a></li>
                </ul>
                
                <div class="tab-content">
                    <div id="tab_1" class="tab-pane active">
                    
                        <div class="portlet box red">
                            <div class="portlet-title">
                                <div class="caption"><i class="fa fa-reorder"></i> {$info['id']?'编辑':'新增'} [{:get_model_by_id($info['model_id'])}] 属性 : <a href="{:U('index','model_id='.$info['model_id'])}">返回列表</a> </div>
                                <div class="tools">
                                    <a href="javascript:;" class="collapse"></a>
                                    <a href="#portlet-config" data-toggle="modal" class="config"></a>
                                    <a href="javascript:;" class="reload"></a>
                                    <a href="javascript:;" class="remove"></a>
                                </div>
                            </div>
                            <div class="portlet-body form">
                                <!-- BEGIN FORM-->
                                
                                    <div class="form-body">
                                    
                                        <div class="form-group">
                                            <label>字段名<span class="check-tips">（请输入字段名 英文字母开头，长度不超过30）</span></label>
                                            <input type="text" class="form-control input-xlarge" name="name" value="{$info.name}">
                                        </div>
                                        <div class="form-group">
                                            <label>字段标题<span class="check-tips">（请输入字段标题，用于表单显示）</span></label>
                                            <input type="text" class="form-control input-xlarge" name="title" value="{$info.title}">
                                        </div>

                                        <div class="form-group">
                                            <label>字段类型<span class="check-tips">（用于表单中的展示方式）</span></label>
                                            <select class="form-control input-medium" name="type" id="data-type">
                                                <option value="">----请选择----</option>
                                                <volist name=":get_attribute_type()" id="type">
                                                <option value="{$key}" rule="{$type[1]}">{$type[0]}</option>
                                                </volist>
                                            </select>
                                        </div>

                                        <div class="form-group">
                                            <label>字段定义<span class="check-tips">（字段属性的sql表示）</span></label>
                                            <input type="text" class="form-control input-xlarge" name="field" value="{$info.field}"  id="data-field" >
                                        </div>
                                        <div class="form-group">
                                            <label>参数<span class="check-tips">（布尔、枚举、多选字段类型的定义数据）</span></label>
                                            <textarea class="form-control input-xlarge" rows="3"  name="extra" >{$info.extra}</textarea>
                                        </div>
                                        <div class="form-group">
                                            <label>默认值<span class="check-tips">（字段的默认值）</span></label>
                                            <input type="text" class="form-control input-xlarge" name="value" value="{$info.value}">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>字段备注<span class="check-tips">（用于表单中的提示）</span></label>
                                            <input type="text" class="form-control input-xlarge" name="remark" value="{$info.remark}">
                                        </div>
                                        <div class="form-group">
                                            <label>是否显示<span class="check-tips">（是否显示在表单中）</span></label>
                                            <select class="form-control input-medium" name="is_show">
                                                <option value="1">始终显示</option>
                                                <option value="2">新增显示</option>
                                                <option value="3">编辑显示</option>
                                                <option value="0">不显示</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>是否必填<span class="check-tips">（用于自动验证）</span></label>
                                            <select class="form-control input-medium" name="is_must">
                                                <option value="0">否</option>
                                                <option value="1">是</option>
                                            </select>
                                        </div>
                                        
                                    </div>
                                    
                                    
                                    <div class="form-actions fluid ">
                                        <div class="col-md-offset-3 col-md-9">   
                                            <input type="hidden" name="id" value="{$info['id']}"/>
                                            <input type="hidden" name="model_id" value="{$info['model_id']}"/>
                                            <button class="btn green submit-btn ajax-post no-refresh" type="submit" target-form="form-1">确 定</button>
                                            <button class="btn default btn-return" onclick="javascript:history.back(-1);return false;">返 回</button>                     
                                        </div>
                                    </div>
                                
                                <!-- END FORM--> 
                            </div>
                        </div>
                        
                    </div>
                    <div id="tab_2" class="tab-pane">
                    
                        <div class="portlet box red">
                            <div class="portlet-title">
                                <div class="caption"><i class="fa fa-reorder"></i> {$info['id']?'编辑':'新增'} [{:get_model_by_id($info['model_id'])}] 属性 : <a href="{:U('index','model_id='.$info['model_id'])}">返回列表</a> </div>
                                <div class="tools">
                                    <a href="javascript:;" class="collapse"></a>
                                    <a href="#portlet-config" data-toggle="modal" class="config"></a>
                                    <a href="javascript:;" class="reload"></a>
                                    <a href="javascript:;" class="remove"></a>
                                </div>
                            </div>
                            <div class="portlet-body form">
                                <!-- BEGIN FORM-->
                                
                                    <div class="form-body">
                                        
                                        <div class="form-group">
                                            <label>验证方式<span class="check-tips"></span></label>
                                            <select class="form-control input-medium" name="validate_type">
                                                <option value="regex">正则验证</option>
                                                <option value="function">函数验证</option>
                                                <option value="unique">唯一验证</option>
                                                <option value="length">长度验证</option>
                                                <option value="in">验证在范围内</option>
                                                <option value="notin">验证不在范围内</option>
                                                <option value="between">区间验证</option>
                                                <option value="notbetween">不在区间验证</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>验证规则<span class="check-tips">（根据验证方式定义相关验证规则）</span></label>
                                            <input type="text" class="form-control input-xlarge" name="validate_rule" value="{$info.validate_rule}">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>出错提示<span class="check-tips">（根据验证方式定义相关验证规则）</span></label>
                                            <input type="text" class="form-control input-xlarge" name="error_info" value="{$info.error_info}">
                                        </div>
                                        <div class="form-group">
                                            <label>验证时间<span class="check-tips"></span></label>
                                            <select class="form-control input-medium" name="validate_time">
                                                <option value="3">始 终</option>
                                                <option value="1">新 增</option>
                                                <option value="2">编 辑</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>自动完成方式<span class="check-tips"></span></label>
                                            <select class="form-control input-medium" name="auto_type">
                                                <option value="function">函数</option>
                                                <option value="field">字段</option>
                                                <option value="string">字符串</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>自动完成规则<span class="check-tips">（根据完成方式订阅相关规则）</span></label>
                                            <input type="text" class="form-control input-xlarge" name="auto_rule" value="{$info.auto_rule}">
                                        </div>
                                        <div class="form-group">
                                            <label>自动完成时间<span class="check-tips"></span></label>
                                            <select class="form-control input-medium" name="auto_time">
                                                <option value="3">始 终</option>
                                                <option value="1">新 增</option>
                                                <option value="2">编 辑</option>
                                            </select>
                                        </div>
                                        
                                        
                                    </div>
                                    
                                    
                                    <div class="form-actions fluid ">
                                        <div class="col-md-offset-3 col-md-9">   
                                            <input type="hidden" name="id" value="{$info['id']}"/>
                                            <input type="hidden" name="model_id" value="{$info['model_id']}"/>
                                            <button class="btn green submit-btn ajax-post no-refresh" type="submit" target-form="form-1">确 定</button>
                                            <button class="btn default btn-return" onclick="javascript:history.back(-1);return false;">返 回</button>                     
                                        </div>
                                    </div>
                                
                                <!-- END FORM--> 
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                </form>
            </div>
        </div>
    </div>
    
</block>


<block name="script">
	<script type="text/javascript" charset="utf-8">
    //导航高亮
    setValue('type', "{$info.type|default=''}");
    setValue('is_show', "{$info.is_show|default=1}");
    setValue('is_must', "{$info.is_must|default=0}");
    setValue('validate_time', "{$info.validate_time|default=3}");
    setValue('auto_time', "{$info.auto_time|default=3}");
    setValue('validate_type', "{$info.validate_type|default='regex'}");
    setValue('auto_type', "{$info.auto_type|default='function'}");
    </script>
	<!-- BEGIN PAGE LEVEL SCRIPTS -->
	<script src="__STATIC__/scripts/app.js"></script>
	<!-- END PAGE LEVEL SCRIPTS -->
	<script>
	jQuery(document).ready(function() {       
		// initiate layout and plugins
		App.init();

        highlight_subnav('{:U('Model/index')}');
		
		<eq name="ACTION_NAME" value="add">
		$(function(){
			$('#data-type').change(function(){
				$('#data-field').val($(this).find('option:selected').attr('rule'));
			});
		})
		</eq>
		
	});
	</script>
</block>


